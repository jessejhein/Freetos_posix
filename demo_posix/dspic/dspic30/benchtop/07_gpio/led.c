/************************************************************************************************
 * File:            led.c
 * Description:     control LED for benchtop board (non-POSIX compliant)
 ***********************************************************************************************/

#include <p30f5011.h>
#include <asm/system.h>

/************************************************************************************************
 * Turn LED On
 ************************************************************************************************/
void led_on(unsigned int led){
    switch(led){
        case 0: LATG &= 0xFFFD; break;
        case 1: LATG |= 0x0001; break;
    }
}

/************************************************************************************************
 * Turn LED Off
 ************************************************************************************************/
void led_off(unsigned int led){
    switch(led){
        case 0: LATG |= 0x0002; break;
        case 1: LATG &= 0xFFFE; break;
    }
}

/************************************************************************************************
 * Current status of LED
 ************************************************************************************************/
int led_status(unsigned int led){
    switch(led){
        case 0: return (_RG1 == 1)? 0: 1;
        case 1: return _RG0;
        default:return -1;
    }   
}

/************************************************************************************************
 * Toggle LED
 ************************************************************************************************/
void led_toggle(unsigned int led){
    if(led_status(led) == 0)
        led_on(led);
    else
        led_off(led);
}

/************************************************************************************************
 * Initialize LED-pins for Digital Outputs
 ************************************************************************************************/
void led_init( void ){
    //Set RG1 LED1 as output
    //Set RG0 Buzzer as output
    TRISG &= 0xFFFC;
    //Clear LED
    LATG |= 0x0002; 
    //Clear Buzzer
    LATG &= 0xFFFE; 
}
