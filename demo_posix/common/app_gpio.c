/************************************************************************************************
 * File:            app_gpio.c
 ***********************************************************************************************/

#include <define.h>
#include <unistd.h>
#include <stdio.h>

#if (KB_MOD == 0)
#error "KB_MOD has been disabled."
#endif

/************************************************************************************************
 * Global Variables
 ***********************************************************************************************/
extern int fd_uart;
extern int fd_kb;

/************************************************************************************************
 * tskKB()
 ***********************************************************************************************/
void* tskKB(void* ptr)
{
    static unsigned char key;
    static char gpio_uart_tx[20];

    //=======================================================================
    start_process();
    //=======================================================================
    while(read(fd_kb, &key, 1) == 1){
        int number = sprintf(gpio_uart_tx, "%s%d%c", "K = ", (int)key, 0x0d);
        write(fd_uart, gpio_uart_tx, number);
        usleep(10000UL);
    }
    sleep(3);

    //=======================================================================
    end_process();
    //=======================================================================
}
